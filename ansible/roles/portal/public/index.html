<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>WikiPlatform - Choisissez votre plan</title>
  <link rel="stylesheet" href="styles.css">

  <!-- Stripe Buy Button script -->
  <script async src="https://js.stripe.com/v3/buy-button.js"></script>
</head>
<body>
  <header>
    <h1>WikiPlatform</h1>
    <nav>
      <a href="/login" class="btn-login">Se connecter via Keycloak</a>
      <a href="https://billing.stripe.com/p/login/test_dRm5kw4oXcfedPj8Xu5c400"
         target="_blank"
         class="btn-action">
        G√©rer mon abonnement
      </a>
    </nav>
  </header>

  <main>
    <p>Choisissez votre plan et d√©marrez en quelques minutes.</p>

    <div class="plans">

      <!-- Starter -->
      <div class="plan-card">
        <h2>Starter</h2>
        <p>Acc√®s au Wiki IA</p>
        <stripe-buy-button
          buy-button-id="buy_btn_1SDphW2zLhYvGbhABjdKi8g3"
          publishable-key="pk_test_51SBp672zLhYvGbhAkJh3sbjSCK9JUhawoQexohGb7Miab7p2Kg8MAv3NCY2l3S8Yt5Vv3tIQ3gwRLUmxOu26i0VH00uedGU1Ke"
          success-url="https://app.wikiplatform.app/success"
          cancel-url="https://app.wikiplatform.app/cancel">
        </stripe-buy-button>
      </div>

      <!-- Pro -->
      <div class="plan-card">
        <h2>Pro</h2>
        <p>Acc√®s aux Wikis IA + DevOps</p>
        <stripe-buy-button
          buy-button-id="buy_btn_1SDpi12zLhYvGbhAzWPy6npv"
          publishable-key="pk_test_51SBp672zLhYvGbhAkJh3sbjSCK9JUhawoQexohGb7Miab7p2Kg8MAv3NCY2l3S8Yt5Vv3tIQ3gwRLUmxOu26i0VH00uedGU1Ke"
          success-url="https://app.wikiplatform.app/success"
          cancel-url="https://app.wikiplatform.app/cancel">
        </stripe-buy-button>
      </div>

      <!-- Enterprise -->
      <div class="plan-card">
        <h2>Enterprise</h2>
        <p>IA + DevOps + Cyber + Support Premium</p>
        <stripe-buy-button
          buy-button-id="buy_btn_1SDpDq2zLhYvGbhAAawk1kPZ"
          publishable-key="pk_test_51SBp672zLhYvGbhAkJh3sbjSCK9JUhawoQexohGb7Miab7p2Kg8MAv3NCY2l3S8Yt5Vv3tIQ3gwRLUmxOu26i0VH00uedGU1Ke"
          success-url="https://app.wikiplatform.app/success"
          cancel-url="https://app.wikiplatform.app/cancel">
        </stripe-buy-button>
      </div>

      <!-- Enterprise+ -->
     <!-- Enterprise+ -->
<div class="plan-card enterprise-plus">
  <h2>Enterprise+</h2>
  <p>Sur mesure</p>
  <p>Wiki d√©di√© avec sous-domaine personnalis√©<br>(ex : clientX.wikiplatform.app)</p>
  <button class="contact-btn" onclick="openForm()">Contacter pour Enterprise+ üåê</button>
</div>

<!-- Fen√™tre modale du formulaire -->
<div id="contactModal" class="modal">
  <div class="modal-content">
    <span class="close" onclick="closeForm()">&times;</span>
    <h3>Demande Enterprise+</h3>
    <p>Remplissez ce formulaire et notre √©quipe vous contactera sous 24h.</p>

    <form id="contactForm" onsubmit="sendMessage(event)">
      <input type="text" id="name" placeholder="Votre nom complet" required>
      <input type="email" id="email" placeholder="Votre adresse e-mail" required>
      <textarea id="message" placeholder="D√©crivez votre besoin..."></textarea>
      <button type="submit" class="btn-send">Envoyer</button>
    </form>

    <p id="formStatus" class="status"></p>
  </div>
</div>

<style>
/* --- Styles du formulaire modal --- */
.modal {
  display: none;
  position: fixed;
  z-index: 10;
  left: 0; top: 0;
  width: 100%; height: 100%;
  background-color: rgba(0,0,0,0.5);
}
.modal-content {
  background: white;
  border-radius: 10px;
  max-width: 400px;
  margin: 10% auto;
  padding: 20px;
  box-shadow: 0 0 15px rgba(0,0,0,0.3);
}
.close {
  float: right;
  cursor: pointer;
  font-size: 22px;
}
#contactForm input, #contactForm textarea {
  width: 100%; margin-bottom: 10px;
  padding: 10px; border-radius: 5px;
  border: 1px solid #ccc; font-size: 14px;
}
.btn-send {
  background: #007bff; color: white;
  border: none; padding: 10px;
  width: 100%; border-radius: 5px;
  cursor: pointer;
}
.status { margin-top: 10px; color: #007bff; font-weight: bold; }
</style>

<script>
async function sendMessage(e) {
  e.preventDefault();

  const name = document.getElementById("name").value;
  const email = document.getElementById("email").value;
  const message = document.getElementById("message").value;
  const status = document.getElementById("formStatus");

  status.textContent = "Envoi en cours...";

  try {
    // ‚úÖ APPEL DIRECT √Ä L'API
    const res = await fetch("http://10.0.1.201:3000/contact-enterprise", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ name, email, message })
    });
    const data = await res.json();

    if (data.success) {
      status.textContent = "‚úÖ Message envoy√© avec succ√®s !";
      document.getElementById("contactForm").reset();
      setTimeout(() => closeForm(), 2000);
    } else {
      status.textContent = "‚ùå Erreur : " + data.message;
    }
  } catch (err) {
    status.textContent = "‚ùå Impossible d'envoyer le message.";
    console.error("Erreur:", err);
  }
}
</script>


    </div>
  </main>

  <footer>
    ¬© 2025 WikiPlatform
  </footer>
</body>
</html>
