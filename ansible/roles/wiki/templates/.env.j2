############################################
# Wiki.js Instance: {{ item.name }}
############################################

# =====================
# Base de donn√©es (RDS)
# =====================
DB_TYPE=postgres
DB_HOST={{ item.pg_host }}
DB_PORT=5432
DB_USER={{ item.pg_user }}
DB_PASS={{ item.pg_pass }}
DB_NAME={{ item.pg_db }}

# =====================
# Authentification OIDC (Keycloak)
# =====================
OIDC_ENABLED=true
OIDC_CLIENT_ID=wiki-{{ item.name }}
OIDC_CLIENT_SECRET={{ kc.clients['wiki-' ~ item.name].secret }}
OIDC_ISSUER=https://auth.{{ base_domain }}/realms/saas
OIDC_SCOPE=openid profile email
OIDC_AUTO_CREATE_USERS=true
OIDC_GROUPS_CLAIM=groups

# =====================
# Stockage (Cloudflare R2)
# =====================
STORAGE_TYPE=s3
AWS_ACCESS_KEY_ID={{ s3_access_key }}
AWS_SECRET_ACCESS_KEY={{ s3_secret_key }}
AWS_ENDPOINT={{ s3_endpoint }}
AWS_REGION=auto
S3_BUCKET=wikijs-{{ item.name }}-files
S3_FORCE_PATH_STYLE=true

# =====================
# Application
# =====================
PORT=3000
BASE_URL=https://{{ item.name }}.{{ base_domain }}
ADMIN_EMAIL={{ item.admin_email }}
ADMIN_PASSWORD={{ item.admin_password }}
LOG_LEVEL=info
LOG_PRETTY=true
LOG_FILE_PATH=logs/wikijs.log
LOG_FILE_MAX_SIZE=10485760
LOG_FILE_MAX_FILES=10       
             